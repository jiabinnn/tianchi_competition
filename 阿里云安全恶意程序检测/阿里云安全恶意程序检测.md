# 阿里云安全恶意程序检测

## 3 特征工程与基线模型

### 3.1 特征工程概述

#### 3.1.2 构造特征

- 基于数据类型的方法
  1. 单个str类型数据：labelendcoder最常见
  2. 基于time的encoder（出现顺序与时间有关）
  3. 单个cate数据类型：ont-hot展开（常用于噪音大的cate数据），count编码，反映数据的流行程度
  4. 单个numerical数据：mean，std，quantile，mode，max，min，range等，用于反映数据的分布
  5. MultiValue数据：CounterVector，TF-IDF等进行拆解
  6. Numerical & numerical： + - * / 或log化之后的+ - * /
  7. Time数据：提取小时，天，节假日信息等

- 基于多分析视角的方法

  这是最常见的一种特征构造方法，在所有的基于table型（结构化数据）的比赛中都会用到，我们以用户是否在未来三天购买同一物品为例，来说明此类数据的构建角度：用户长期购物特征，用户长期购买频率；用户短期购物特征，用户近期购物频率；物品受欢迎程度，该物品最近受欢迎程度；用户对此类产品的喜好特征：用户之前购买该类/该商品的频率等信息；时间特征：是否到用户发工资的时间段；商品是否为用户的必备品，如洗漱用品、每隔多长时间必买等。

#### 3.1.3 特征选择

特征选择主要包括过滤法，包装法和嵌入法

### 3.2 构造线下验证集

#### 3.2.1 评估穿越

1. **时间穿越**

2. **会话穿越**

3. **穿越本质**

   穿越本质上是信息泄露的问题。无论时间穿越，还是会话穿越，其核心问题都是训练数据中的信息以不同方式、不同程度泄露到了测试数据中。

#### 3.2.2 训练集和测试集的特征差异性

我们用训练集训练模型，当训练集和测试集的特征分布有差异时，就容易造成模型偏差，导致预测不准确。常见的训练集和测试集的特征差异如下：

- 数据特征：训练集和测试集的特征分布交叉部分极小
- 类别特征：测试集的特征大量未出现在训练集中。例如，在微软的一场比赛中，测试集的很多版本未出现在训练集中。
- 在某些极端情况下，训练集中极强的特征会在测试集中全部丢失。

#### 3.2.3 训练集和测试集的分布差异性

训练集和测试集的分布差异性的判断步骤如下：

将训练集的数据标记为label=1， 将测试集的数据标记为label=0。

对训练集和测试集做5折的auc交叉验证。如果auc在0.5附近，那么则说明训练集和测试集的分布差异不大；如果auc在0.9附近，那么说明训练集和测试集的分布差异很大。